library(edgeR)
counts <- read.delim("gene_counts_clean.matrix.tsv", row.names = 1, check.names = FALSE)
head(counts)
group <- factor(c("Control", "Control","Treatment", "Treatment"))
dge <- DGEList(counts = counts, group = group)
keep <- filterByExpr(dge)
dge <- dge[keep, , keep.lib.sizes = FALSE]
dge <- calcNormFactors(dge)
design <- model.matrix(~group)
dge <- estimateDisp(dge, design)
fit <- glmQLFit(dge, design)
qlf <- glmQLFTest(fit, coef = 2)  # Treatment vs Control
topTags(qlf)
results <- topTags(qlf, n = nrow(dge$counts))$table
write.csv(results, file = "edgeR_results.csv")
library(EnhancedVolcano)
EnhancedVolcano(results,
                lab = rownames(results),
                x = 'logFC',
                y = 'PValue')
